<div class="eqLogic eqLogic-widget allowResize allowReorderCmd jeeHistoGraph #custom_layout# #eqLogic_class# #class#"
    data-eqType="#eqType#"
    data-eqLogic_id="#id#" data-eqLogic_uid="#uid#" data-version="#version#"
    style="width: #width#;height: #height#;#style#; display: flex; flex-direction: column; overflow: hidden;">

    <center class="widget-name" style="flex: 0 0 auto; padding: 5px 0; font-size: 0.9em;">
        <span class="reportModeVisible">#name_display# <span class="object_name">#object_name#</span></span>
        <a href="#eqLink#" class="reportModeHidden">#name_display# <span class="object_name">#object_name#</span></a>
    </center>

    <!-- === CSS intégré - 2 graphiques empilés === -->
    <style>
        .jeeHistoGraph .graphs-container {
            height: 100%;
            display: grid;
            gap: 8px;
            padding: 5px;
            overflow: hidden;
            box-sizing: border-box;
        }

        .jeeHistoGraph .graphs-container > div {
            min-height: 120px;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        /* === 1 graphique === */
        .jeeHistoGraph .graphs-layout-1 {
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
        }

        /* === 2 graphiques : empilés (1 au-dessus, 1 en dessous) === */
        .jeeHistoGraph .graphs-layout-2 {
            grid-template-columns: 1fr;
            grid-template-rows: 1fr 1fr;
        }

        /* === 3 graphiques : 2 en haut, 1 en bas pleine largeur === */
        .jeeHistoGraph .graphs-layout-3 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }
        .jeeHistoGraph .graphs-layout-3 > div:nth-child(1) { grid-column: 1; grid-row: 1; }
        .jeeHistoGraph .graphs-layout-3 > div:nth-child(2) { grid-column: 2; grid-row: 1; }
        .jeeHistoGraph .graphs-layout-3 > div:nth-child(3) { grid-column: 1 / -1; grid-row: 2; }

        /* === 4 graphiques : grille 2×2 === */
        .jeeHistoGraph .graphs-layout-4 {
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
        }

    </style>

    <!-- Conteneur avec classe dynamique -->
    <div class="graphs-container graphs-layout-#nbGraphs#">
        #graph_containers#
    </div>

    <script>
        try {
            const nbGraphs = #nbGraphs#;
            const graphType = '#graphType#';
            const unite = '#unite#';

            #chart_scripts#
        } catch(e) {
            console.error('Erreur Highcharts:', e);
        }
    </script>
</div>